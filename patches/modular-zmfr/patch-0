diff -ruN orig/zmcore.c new/zmcore.c
--- orig/zmcore.c	2004-11-11 23:14:23.000000000 -0800
+++ new/zmcore.c	2004-11-11 23:25:41.000000000 -0800
@@ -18,7 +18,7 @@
 #include <error.h>
 #include <estdlib.h>
 
-#include "zmext.h"
+#include "zmextm.h"
 #include "zmcore.h"
 #include "zmfr.h"
 #include "unused.h"
diff -ruN orig/zmcore.h new/zmcore.h
--- orig/zmcore.h	1996-11-09 23:04:26.000000000 -0800
+++ new/zmcore.h	2004-11-11 23:20:41.000000000 -0800
@@ -14,6 +14,7 @@
 #define ZMCORE_INCLUDED
 
 #include <stdio.h>
+#include <time.h>
 
 #include "zmext.h"
 
@@ -40,6 +41,8 @@
     size_t maxTx;
     long goodOffset;
     long filesize;
+    time_t filetime;
+    int filemode;
     int gotSpecial;
     int gotHeader;
     int moreData;
diff -ruN orig/zmextm.c new/zmextm.c
--- orig/zmextm.c	1969-12-31 16:00:00.000000000 -0800
+++ new/zmextm.c	2004-11-12 08:06:01.000000000 -0800
@@ -0,0 +1,116 @@
+/*********************************************************************/
+/*                                                                   */
+/*  This Program Written by Paul Edwards, 3:711/934@fidonet.         */
+/*  Released to the Public Domain                                    */
+/*                                                                   */
+/*********************************************************************/
+/*********************************************************************/
+/*                                                                   */
+/*  zmextm.c - extModem routines                                     */
+/*                                                                   */
+/*********************************************************************/
+
+#include <stdlib.h>
+#include <stdio.h>
+
+#include <error.h>
+#include <trav.h>
+#include <unused.h>
+
+#include "zmextm.h"
+#include "pdcomm.h"
+
+void extModemClearInbound(ZMCORE *zmcore, ZMEXT *zmext)
+{
+    unsigned char buf[200];
+
+    unused(zmcore);    
+    while (pdcommReadBuf(zmext->pdcomm, buf, sizeof buf) == sizeof buf) ;
+    return;
+}
+
+void extModemResponseSent(ZMCORE *zmcore, ZMEXT *zmext)
+{
+    unused(zmcore);
+    unused(zmext);
+    return;
+}
+
+void extModemGetBlock(ZMCORE *zmcore, 
+                      ZMEXT *zmext, 
+                      void *buf, 
+                      size_t max, 
+                      size_t *actual)
+{
+    int x;
+    int cnt;
+    
+    unused(zmcore);
+    x = pdcommReadBuf(zmext->pdcomm, buf, max);
+    if (x == 0)
+    {
+        /* wait for 2 seconds for response */
+        for (cnt = 0; cnt < 200; cnt++)
+        {
+#ifndef MSDOS    
+            DosSleep(10);
+#else
+            delay(10);
+#endif            
+            x = pdcommReadBuf(zmext->pdcomm, buf, max);
+            if (x != 0) break;
+        }
+    }
+    if (x == 0)
+    {
+        errorSet(ZMODEM_TIMEOUT);
+    }
+    *actual = x;
+    return;
+}
+
+void extModemRegisterBad(ZMCORE *zmcore, ZMEXT *zmext)
+{
+    unused(zmcore);
+    unused(zmext);
+    return;
+}
+
+void extModemRegisterGood(ZMCORE *zmcore, ZMEXT *zmext)
+{
+    unused(zmcore);
+    unused(zmext);
+    return;
+}
+
+void extModemGetBlockImm(ZMCORE *zmcore, 
+                         ZMEXT *zmext,
+                         void *buf, 
+                         size_t max, 
+                         size_t *actual)
+{
+    int x;
+
+    unused(zmcore);
+    x = pdcommReadBuf(zmext->pdcomm, buf, max);
+    *actual = x;
+    if (x == 0)
+    {
+        errorSet(ZMODEM_TIMEOUT);
+    }
+    return;
+}
+
+void extModemWriteBlock(ZMCORE *zmcore, ZMEXT *zmext, void *buf, size_t max)
+{
+/*    FILE *fq; */
+
+    unused(zmcore);    
+    pdcommWriteBuf(zmext->pdcomm, buf, max);
+    
+/*    fq = fopen("debug.log", "ab");
+    fwrite(buf, max, 1, fq);
+    fclose(fq); */
+    return;
+}
+
diff -ruN orig/zmextm.h new/zmextm.h
--- orig/zmextm.h	1969-12-31 16:00:00.000000000 -0800
+++ new/zmextm.h	2004-11-11 23:25:52.000000000 -0800
@@ -0,0 +1,32 @@
+/*********************************************************************/
+/*                                                                   */
+/*  This Program Written by Paul Edwards, 3:711/934@fidonet.         */
+/*  Released to the Public Domain                                    */
+/*                                                                   */
+/*********************************************************************/
+/*********************************************************************/
+/*                                                                   */
+/*  zmextm - extModem routines                                       */
+/*                                                                   */
+/*********************************************************************/
+
+#include <stddef.h>
+
+#include "zmcore.h"
+
+void extModemClearInbound(ZMCORE *zmcore, ZMEXT *zmext);
+void extModemResponseSent(ZMCORE *zmcore, ZMEXT *zmext);
+void extModemGetBlock(ZMCORE *zmcore, 
+                      ZMEXT *zmext, 
+                      void *buf, 
+                      size_t max, 
+                      size_t *actual);
+void extModemRegisterBad(ZMCORE *zmcore, ZMEXT *zmext);
+void extModemRegisterGood(ZMCORE *zmcore, ZMEXT *zmext);
+void extModemGetBlockImm(ZMCORE *zmcore,
+                         ZMEXT *zmext,
+                         void *buf, 
+                         size_t max, 
+                         size_t *actual);
+void extModemWriteBlock(ZMCORE *zmcore, ZMEXT *zmext, void *buf, size_t max);
+
diff -ruN orig/zmfr.c new/zmfr.c
--- orig/zmfr.c	1996-11-30 05:45:52.000000000 -0800
+++ new/zmfr.c	2004-11-11 23:28:08.000000000 -0800
@@ -17,105 +17,9 @@
 #include <trav.h>
 #include <unused.h>
 
-#include "zmext.h"
-#include "zmcore.h"
 #include "zmfr.h"
 #include "pdcomm.h"
 
-void extModemClearInbound(ZMCORE *zmcore, ZMEXT *zmext)
-{
-    unsigned char buf[200];
-
-    unused(zmcore);    
-    while (pdcommReadBuf(zmext->pdcomm, buf, sizeof buf) == sizeof buf) ;
-    return;
-}
-
-void extModemResponseSent(ZMCORE *zmcore, ZMEXT *zmext)
-{
-    unused(zmcore);
-    unused(zmext);
-    return;
-}
-
-void extModemGetBlock(ZMCORE *zmcore, 
-                      ZMEXT *zmext, 
-                      void *buf, 
-                      size_t max, 
-                      size_t *actual)
-{
-    int x;
-    int cnt;
-    
-    unused(zmcore);
-    x = pdcommReadBuf(zmext->pdcomm, buf, max);
-    if (x == 0)
-    {
-        /* wait for 2 seconds for response */
-        for (cnt = 0; cnt < 200; cnt++)
-        {
-#ifndef MSDOS    
-            DosSleep(10);
-#else
-            delay(10);
-#endif            
-            x = pdcommReadBuf(zmext->pdcomm, buf, max);
-            if (x != 0) break;
-        }
-    }
-    if (x == 0)
-    {
-        errorSet(ZMODEM_TIMEOUT);
-    }
-    *actual = x;
-    return;
-}
-
-void extModemRegisterBad(ZMCORE *zmcore, ZMEXT *zmext)
-{
-    unused(zmcore);
-    unused(zmext);
-    return;
-}
-
-void extModemRegisterGood(ZMCORE *zmcore, ZMEXT *zmext)
-{
-    unused(zmcore);
-    unused(zmext);
-    return;
-}
-
-void extModemGetBlockImm(ZMCORE *zmcore, 
-                         ZMEXT *zmext,
-                         void *buf, 
-                         size_t max, 
-                         size_t *actual)
-{
-    int x;
-
-    unused(zmcore);
-    x = pdcommReadBuf(zmext->pdcomm, buf, max);
-    *actual = x;
-    if (x == 0)
-    {
-        errorSet(ZMODEM_TIMEOUT);
-    }
-    return;
-}
-
-void extModemWriteBlock(ZMCORE *zmcore, ZMEXT *zmext, void *buf, size_t max)
-{
-/*    FILE *fq; */
-
-    unused(zmcore);    
-    pdcommWriteBuf(zmext->pdcomm, buf, max);
-    
-/*    fq = fopen("debug.log", "ab");
-    fwrite(buf, max, 1, fq);
-    fclose(fq); */
-    return;
-}
-   
 void extFileSetInfo(ZMCORE *zmcore,
                     ZMEXT *zmext,
                     unsigned char *filename, 
diff -ruN orig/zmfr.h new/zmfr.h
--- orig/zmfr.h	1996-11-29 12:28:38.000000000 -0800
+++ new/zmfr.h	2004-11-11 23:10:43.000000000 -0800
@@ -15,21 +15,6 @@
 #include "zmcore.h"
 #include "zmext.h"
 
-void extModemClearInbound(ZMCORE *zmcore, ZMEXT *zmext);
-void extModemResponseSent(ZMCORE *zmcore, ZMEXT *zmext);
-void extModemGetBlock(ZMCORE *zmcore, 
-                      ZMEXT *zmext, 
-                      void *buf, 
-                      size_t max, 
-                      size_t *actual);
-void extModemRegisterBad(ZMCORE *zmcore, ZMEXT *zmext);
-void extModemRegisterGood(ZMCORE *zmcore, ZMEXT *zmext);
-void extModemGetBlockImm(ZMCORE *zmcore,
-                         ZMEXT *zmext,
-                         void *buf, 
-                         size_t max, 
-                         size_t *actual);
-void extModemWriteBlock(ZMCORE *zmcore, ZMEXT *zmext, void *buf, size_t max);
 void extFileSetInfo(ZMCORE *zmcore,
                     ZMEXT *zmext,
                     unsigned char *filename, 
