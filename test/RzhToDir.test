# Test Rz/Sz
# Scott Bronson
# 4 Nov 2004

# This test is the same as RzhSz, except that it names the directory
# to save to on the command line.

rm -rf /tmp/tmtest-zmodem /tmp/tmtest-zmodem-pipe /tmp/tmtest-zmodem-data

mkdir /tmp/tmtest-zmodem
mkfifo /tmp/tmtest-zmodem-pipe
randfile --seed=1 --size=512 > /tmp/tmtest-zmodem-data

# sz outputs sometimes outputs a ^M on stderr so we need to just discard it.
sz -q /tmp/tmtest-zmodem-data 2>/dev/null < /tmp/tmtest-zmodem-pipe | \
	rzh -rq /tmp/tmtest-zmodem > /tmp/tmtest-zmodem-pipe

randfile --seed=1 --size=512 --check < /tmp/tmtest-zmodem/tmtest-zmodem-data

------ STDOUT: exit code 0 - no error
